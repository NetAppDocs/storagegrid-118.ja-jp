---
permalink: troubleshoot/troubleshoot-low-watermark-alert.html 
sidebar: sidebar 
keywords: troubleshoot low soft read-only watermark override alert, optimized watermarks 
summary: ストレージボリュームのウォーターマークにカスタム値を使用する場合は、「読み取り専用の下限のウォーターマーク上書き」アラートを解決する必要があります。可能であれば、最適化された値の使用を開始するようにシステムを更新してください。 
---
= 読み取り専用のローウォーターマーク上書きアラートのトラブルシューティング
:allow-uri-read: 
:icons: font
:imagesdir: ../media/


[role="lead"]
ストレージボリュームのウォーターマークにカスタム値を使用する場合は、「読み取り専用の低ウォーターマーク上書き * 」アラートを解決する必要があります。可能であれば、最適化された値の使用を開始するようにシステムを更新してください。

以前のリリースでは link:../admin/what-storage-volume-watermarks-are.html["ストレージボリュームのウォーターマーク"] グローバル設定：すべてのストレージノード上のすべてのストレージボリュームに同じ値が適用されていた。StorageGRID 11.6 以降では、ストレージノードのサイズとボリュームの相対容量に基づいて、ストレージボリュームごとにこれらのウォーターマークを最適化できます。

StorageGRID 11.6以降にアップグレードすると、次のいずれかに該当する場合を除き、最適化された読み取り専用ウォーターマークと読み取り/書き込みウォーターマークがすべてのストレージボリュームに自動的に適用されます。

* システムは容量に近く、最適化されたウォーターマークが適用されている場合は新しいデータを受け入れられません。この場合、 StorageGRID はウォーターマーク設定を変更しません。
* 以前にストレージボリュームのウォーターマークをカスタム値に設定している。StorageGRID では、カスタムウォーターマーク設定を最適化された値で上書きしません。ただし、 Storage Volume Soft Read-Only Watermark のカスタム値が小さすぎると、 StorageGRID は「 Low read-only watermark overrid* 」アラートをトリガーする場合があります。




== アラートを確認します

ストレージボリュームのウォーターマークにカスタム値を使用すると、 1 つ以上のストレージノードに対して * 読み取り専用の低ウォーターマーク上書き * アラートがトリガーされる可能性があります。

アラートの各インスタンスは、 * Storage Volume Soft Read-Only Watermark * のカスタム値が、そのストレージノードの最適化された最小値より小さくなっていることを示しています。カスタム設定を引き続き使用すると、ストレージノードのスペースが非常に少なくなる可能性があります。この値を超えると、ストレージノードは読み取り専用状態に安全に移行できます。ノードの容量が上限に達すると、一部のストレージボリュームにアクセスできなくなる（自動的にアンマウントされる）ことがあります。

たとえば、 * Storage Volume Soft Read-Only Watermark * を 5GB に設定しているとします。次に、ストレージノード A の 4 つのストレージボリュームについて、 StorageGRID が次の最適化値を計算したとします。

[cols="2a,2a"]
|===


 a| 
ボリューム0
 a| 
12GB



 a| 
ボリューム 1
 a| 
12GB



 a| 
巻2
 a| 
11GB



 a| 
巻三
 a| 
15 GB

|===
カスタムのウォーターマーク（ 5GB ）がそのノード内のすべてのボリュームに対する最小最適値（ 11GB ）よりも小さいため、「 Low read-only watermark overrid* 」アラートがストレージノード A に対してトリガーされます。カスタム設定を引き続き使用すると、ノードが読み取り専用状態に安全に移行できるようになる前に、ノードのスペースが非常に少なくなる可能性があります。



== アラートを解決します

1 つ以上の * 読み取り専用の低ウォーターマーク上書き * アラートがトリガーされた場合は、次の手順を実行します。また、現在カスタムのウォーターマーク設定を使用しており、アラートがトリガーされていない場合でも最適化された設定の使用を開始する場合にも、この手順を使用できます。

.作業を開始する前に
* StorageGRID 11.6以降へのアップグレードが完了している。
* を使用して Grid Manager にサインインします link:../admin/web-browser-requirements.html["サポートされている Web ブラウザ"]。
* を使用することができます link:../admin/admin-group-permissions.html["rootアクセス権限"]。


.このタスクについて
カスタム・ウォーターマーク設定を新しいウォーターマークの上書きに更新することにより ' 読み取り専用のロー・ウォーターマーク・オーバーライド * アラートを解決できますただし、 1 つ以上のストレージノードがいっぱいに近づいている場合や特別な ILM 要件がある場合は、まず最適化されたストレージウォーターマークを表示して、そのノードを安全に使用できるかどうかを確認する必要があります。



=== グリッド全体のオブジェクトデータ使用量を評価します

.手順
. [* nodes （ノード） ] を選択します
. グリッド内のサイトごとに、ノードのリストを展開します。
. 各サイトの各ストレージノードについて、「 * Object Data Used * 」列に表示されている割合値を確認します。
+
image::../media/nodes_page_object_data_used_with_alert.png[3 つの SN で使用されているオブジェクトデータが表示されるノードページ]

. 該当する手順を実行します。
+
.. ほぼすべてのストレージノードが上限に近い場合（使用済みオブジェクトデータがすべて * されている値が 80% 未満の場合など）は、無視設定を使用できます。に進みます <<use-optimized-watermarks,最適化されたウォーターマークを使用>>。
.. ILMルールの取り込み動作がStrictに設定されている場合や特定のストレージプールがフルに近い場合は、の手順を実行します。 <<view-optimized-watermarks,最適化されたストレージウォーターマークを表示する>> および <<determine-optimized-watermarks,最適化されたウォーターマークを使用できるかどうかを確認します>>。






=== [[view-optimized-watermarks]]最適化されたストレージのウォーターマークの表示

StorageGRID は、 2 つの Prometheus 指標を使用して、 * Storage Volume Soft Read-Only Watermark * に対して計算された最適値を表示します。グリッド内の各ストレージノードの最適化された最小値と最大値を表示できます。

.手順
. [*support*>] 、 [*Tools] 、 [*Metrics] の順に選択します。
. Prometheus セクションで、 Prometheus ユーザインターフェイスへのリンクを選択します。
. 推奨されるソフト読み取り専用の最小ウォーターマークを確認するには、次の Prometheus 指標を入力し、 * Execute * を選択します。
+
`storagegrid_storage_volume_minimum_optimized_soft_readonly_watermark`

+
最後の列には、各ストレージノード上のすべてのストレージボリュームに対して Soft Read-Only Watermark の最小最適値が表示されます。この値が * Storage Volume Soft Read ‐ Only Watermark * のカスタム設定より大きい場合、ストレージノードに対して * Low read-only watermark override * アラートがトリガーされます。

. 推奨されるソフト読み取り専用の最大ウォーターマークを確認するには、次の Prometheus 指標を入力し、 * Execute * を選択します。
+
`storagegrid_storage_volume_maximum_optimized_soft_readonly_watermark`

+
最後の列には、各ストレージノード上のすべてのストレージボリュームに対して Soft Read-Only Watermark の最大最適値が表示されます。

. [[maximum_optimized_value] 各ストレージノードの最適化された最大値をメモします。




=== [[determine-optimized-watermarks]]最適化されたウォーターマークを使用できるかどうかを判断する

.手順
. [* nodes （ノード） ] を選択します
. オンラインのストレージノードごとに上記の手順を繰り返します。
+
.. [*_Storage Node_*>* Storage*] を選択します。
.. [Object Stores] テーブルまで下にスクロールします。
.. 各オブジェクトストア（ボリューム）の Available * 値を、そのストレージノード用にメモした最大最適ウォーターマークと比較します。


. 各オンラインストレージノード上の少なくとも 1 つのボリュームに、そのノードの最大最適ウォーターマークを超える使用可能なスペースがある場合は、に進みます <<use-optimized-watermarks,最適化されたウォーターマークを使用>> 最適化されたウォーターマークの使用を開始します。
+
それ以外の場合は、できるだけ早くグリッドを拡張してください。または link:../expand/adding-storage-volumes-to-storage-nodes.html["ストレージボリュームを追加します"] を既存のノードまたはに追加します link:../expand/adding-grid-nodes-to-existing-site-or-adding-new-site.html["新しいストレージノードを追加します"]。次に、に進みます <<use-optimized-watermarks,最適化されたウォーターマークを使用>> ウォーターマークの設定を更新します。

. ストレージボリュームのウォーターマークにカスタム値を引き続き使用する必要がある場合は、 link:../monitor/silencing-alert-notifications.html["無音"] または link:../monitor/disabling-alert-rules.html["- 無効にします"] 「 * 読み取り専用のロー・ウォーターマーク・オーバーライド * 」アラート。
+

NOTE: 各ストレージノード上の各ストレージボリュームには、同じカスタムのウォーターマーク値が適用されます。ストレージボリュームのウォーターマーク原因 に推奨よりも小さい値を使用すると、ノードの容量に達したときに一部のストレージボリュームにアクセスできなくなる（自動的にアンマウントされる）ことがあります。





=== [[use-optimized-watermarks]]最適化されたウォーターマークを使用する

.手順
. [サポート]*>*[その他]*>*[ストレージのウォーターマーク]*を選択します。
. [最適化された値を使用する]チェックボックスをオンにします。
. [ 保存（ Save ） ] を選択します。


ストレージノードのサイズとボリュームの相対容量に基づいて、ストレージボリュームごとに最適化されたストレージボリュームのウォーターマーク設定が有効になりました。
